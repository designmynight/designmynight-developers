<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-gb">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <title> - DMN developer documentation</title>
    <meta name="generator" content="Hugo 0.22.1" />

    
    <meta name="description" content="Developer documentation for DesignMyNight">
    
    <link rel="canonical" href="https://developers.designmynight.com/collins/tracking/">
    
    <meta name="author" content="DesignMyNight Tech Team">
    

    <meta property="og:url" content="https://developers.designmynight.com/collins/tracking/">
    <meta property="og:title" content="DMN developer documentation">
    <meta property="og:image" content="https://developers.designmynight.com/images/logo.png">
    <meta name="apple-mobile-web-app-title" content="DMN developer documentation">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="https://developers.designmynight.com/images/favicon.png">
    <link rel="icon" type="image/x-icon" href="https://developers.designmynight.com/images/favicon.png">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('https://developers.designmynight.com/fonts/icon.eot?52m981');
        src: url('https://developers.designmynight.com/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
             url('https://developers.designmynight.com/fonts/icon.woff?52m981')
               format('woff'),
             url('https://developers.designmynight.com/fonts/icon.ttf?52m981')
               format('truetype'),
             url('https://developers.designmynight.com/fonts/icon.svg?52m981#icon')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="https://developers.designmynight.com/stylesheets/application.css">
    <link rel="stylesheet" href="https://developers.designmynight.com/stylesheets/palettes.css">
    <link rel="stylesheet" href="https://developers.designmynight.com/stylesheets/styles.css">
    <link rel="stylesheet" href="https://developers.designmynight.com/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu%20Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>
    
    
    <script src="https://developers.designmynight.com/javascripts/modernizr.js"></script>

  </head>
  <body class="palette-primary-teal palette-accent-deep purple">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
      </div>
    </div>

    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/designmynight/dmn-developers" title="@designmynight/dmn-developers on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="https://developers.designmynight.com/" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="https://developers.designmynight.com/images/logo.png">
        </div>
      
      <div class="name">
        <strong>DMN developer documentation <span class="version">1.1.0</span></strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Introduction" href="https://developers.designmynight.com/">
	
	Introduction
</a>

  
  
</li>



<li>
  
    



<a  title="    " href="https://developers.designmynight.com/">
	
	    
</a>

  
  
</li>



<li>
  
  <li>
    

    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
      <span class="section">Soda</span>
      
    
      
    
      
    
      
    
    

    <ul>
      
        
        



<a  title="Voucher widget" href="https://developers.designmynight.com/soda/partner-widget/">
	
	Voucher widget
</a>

  
      
    </ul>
  </li>
  
</li>



<li>
  
  <li>
    

    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
      <span class="section">Tonic</span>
      
    
    

    <ul>
      
        
        



<a  title="Ticket widget" href="https://developers.designmynight.com/tonic/ticket-widget/">
	
	Ticket widget
</a>

  
      
    </ul>
  </li>
  
</li>



<li>
  
    



<a  title="     " href="https://developers.designmynight.com/">
	
	     
</a>

  
  
</li>



<li>
  
  <li>
    

    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
      <span class="section">Collins</span>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
    

    <ul>
      
        
        



<a  title="Updating Email Settings" href="https://developers.designmynight.com/collins/updating-email-settings/">
	
	Updating Email Settings
</a>

  
      
        
        



<a  title="V1 Booking Widget" href="https://developers.designmynight.com/collins/booking-widget/">
	
	V1 Booking Widget
</a>

  
      
        
        



<a  title="V1 Widget: Customising 2nd Iframe" href="https://developers.designmynight.com/collins/customising-2nd-iframe/">
	
	V1 Widget: Customising 2nd Iframe
</a>

  
      
        
        



<a class="current" title="V1 Widget: Tracking" href="https://developers.designmynight.com/collins/tracking/">
	
	V1 Widget: Tracking
</a>


<ul id="scrollspy">
</ul>
  
      
        
        



<a  title="V2 Booking Widget" href="https://developers.designmynight.com/collins/v2-widget-docs/">
	
	V2 Booking Widget
</a>

  
      
        
        



<a  title="V2 Widget: Customising Second Stage" href="https://developers.designmynight.com/collins/customising-second-stage-of-v2-widget/">
	
	V2 Widget: Customising Second Stage
</a>

  
      
        
        



<a  title="V2 Widget: Tracking" href="https://developers.designmynight.com/collins/v2-widget-tracking/">
	
	V2 Widget: Tracking
</a>

  
      
        
        



<a  title="Booking URLs" href="https://developers.designmynight.com/collins/booking-url/">
	
	Booking URLs
</a>

  
      
        
        



<a  title="General Enquiry Form" href="https://developers.designmynight.com/collins/general-enquiry-form/">
	
	General Enquiry Form
</a>

  
      
        
        



<a  title="Customising Email Templates" href="https://developers.designmynight.com/collins/customising-email-templates/">
	
	Customising Email Templates
</a>

  
      
    </ul>
  </li>
  
</li>



<li>
  
    



<a  title=" " href="https://developers.designmynight.com/">
	
	 
</a>

  
  
</li>



<li>
  
  <li>
    

    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
      <span class="section">Api</span>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
    

    <ul>
      
        
        



<a  title="API Basics" href="https://developers.designmynight.com/api/api-basics/">
	
	API Basics
</a>

  
      
        
        



<a  title="Booking API" href="https://developers.designmynight.com/api/booking-api/">
	
	Booking API
</a>

  
      
        
        



<a  title="Bookings search" href="https://developers.designmynight.com/api/bookings-search/">
	
	Bookings search
</a>

  
      
        
        



<a  title="Users API" href="https://developers.designmynight.com/api/users-api/">
	
	Users API
</a>

  
      
        
        



<a  title="Offers API" href="https://developers.designmynight.com/api/offers-api/">
	
	Offers API
</a>

  
      
        
        



<a  title="Venues API" href="https://developers.designmynight.com/api/venues-api/">
	
	Venues API
</a>

  
      
        
        



<a  title="Venue Groups API" href="https://developers.designmynight.com/api/venue-groups/">
	
	Venue Groups API
</a>

  
      
        
        



<a  title="API FAQs" href="https://developers.designmynight.com/api/api-faqs/">
	
	API FAQs
</a>

  
      
    </ul>
  </li>
  
</li>



<li>
  
    



<a  title="        " href="https://developers.designmynight.com/">
	
	        
</a>

  
  
</li>



<li>
  
  <li>
    

    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
      <span class="section">Epos-Crm-Integrations</span>
      
    
      
    
      
    
      
    
      
    
      
    
    

    <ul>
      
        
        



<a  title="EPOS Integration" href="https://developers.designmynight.com/epos-crm-integrations/epos-integration">
	
	EPOS Integration
</a>

  
      
        
        



<a  title="Zonal EPOS Integration" href="https://developers.designmynight.com/epos-crm-integrations/zonal-epos-integration/">
	
	Zonal EPOS Integration
</a>

  
      
        
        



<a  title="IBS EPOS Integration" href="https://developers.designmynight.com/epos-crm-integrations/ibs-epos-integration/">
	
	IBS EPOS Integration
</a>

  
      
        
        



<a  title="Tevalis EPOS Integration" href="https://developers.designmynight.com/epos-crm-integrations/tevalis-epos-integration/">
	
	Tevalis EPOS Integration
</a>

  
      
        
        



<a  title="Kobas EPOS Integration" href="https://developers.designmynight.com/epos-crm-integrations/kobas-epos-integration/">
	
	Kobas EPOS Integration
</a>

  
      
        
        



<a  title="CRM Integration" href="https://developers.designmynight.com/epos-crm-integrations/crm-integration/">
	
	CRM Integration
</a>

  
      
    </ul>
  </li>
  
</li>



<li>
  
    



<a  title="          " href="https://developers.designmynight.com/">
	
	          
</a>

  
  
</li>

        </ul>
        

        
        <hr>
        <span class="section">&#9829; DesignMyNight Tech Team</span>        
        
        <ul>
          

          
          <li>
            <a href="https://github.com/designmynight/dmn-developers" target="_blank" title="@designmynight/dmn-developers on GitHub">
              @designmynight/dmn-developers on GitHub
            </a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1> </h1>

			

<h1 id="tracking-on-the-v1-collins-widget">Tracking on the V1 Collins Widget</h1>

<p>There are 3 ways you can look at tracking:</p>

<h2 id="google-tracking">Google Tracking</h2>

<p>Putting Google code on the first enquire button in the CSS (this isn&rsquo;t tracking to completion but the drop off rate is about 10% on average from loading up the iframe so a quick and easy way to get a pretty accurate reading). Useful guide for developers on <a href="https://collins.uservoice.com/knowledgebase/articles/863856-adding-google-analytics-tracking-code-to-the-booki">Adding Google Analytics Tracking Code to the booking widget</a>.</p>

<h2 id="custom-return-url">Custom return URL</h2>

<p>You can create a custom return URL for users to be directed to when they complete their booking. That way you&rsquo;d be responsible for displaying all the info to the users and having your own confirmation page not the DMN one we currently have. You will then have control to add your own Google Analytics* to track bookings.</p>

<p>To do this you need to create the return URL on the  venue site then set it using custom script after your partner form:</p>

<pre><code>&lt;script&gt;
  DMN.val('return_url', 'https://www.your-return-url.com/booking-complete');
  DMN.val('return_method', 'post');
&lt;/script&gt; 
</code></pre>

<p><strong><em>Please note:</em></strong> It will be up to your web developer to select which booking details are displayed on the custom return page. The booking details will be returned to you in our default format, if you want to reformat any details (eg the way that the date displays), this will be up to your web developer to format. Please ensure that your webserver and application can accept POST requests from the designmynight.com domain, including any subdomains.</p>

<p>*<strong>Google Analytics Notes:</strong> You will need to have cross-domain tracking in place. This also includes making sure that the tags that are fired from your hostname also have cross-domain tracking in place. Part of setting up cross-domain tracking is to ensure that client&rsquo;s and your hostnames are added to the referral exclusion list.</p>

<p>Ideally, you also need to ensure that your Google Analytics is in a good shape overall - e.g. only use universal analytics pixels, there is no double-tagging, etc.</p>

<h2 id="using-our-api-big-tech-build-we-do-not-recommend">Using our API <em>(big tech build, we do not recommend)</em></h2>

<p>Use our API to build out your own checkout which you can track completely as you want then you can do whatever you want - big tech build - <a href="http://developers.designmynight.com/">developers.designmynight.com</a></p>

<h2 id="tracking-faqs">Tracking FAQs</h2>

<p><strong>1. All the details captured from the user are returned in the query string within my return URL. Is is possible to stop this?</strong></p>

<p>Yes. Add the following code underneath your existing <code>return_url</code>:</p>

<pre><code>DMN.val('return_method', 'post');
</code></pre>

<p>Following GDPR, we have deprecated GET return URLs since they include customer&rsquo;s personal information in the URL, which is less safe than using a POST which does not include details in the URL. Additionally, we now require that all return URLs are hosted on a secure (HTTPS) URL. This ensures that customer data is encrypted in compliance with GDPR legislation.</p>

<p><strong>2. What information should we include in the custom return URL?</strong></p>

<p>All customers will automatically receive an Enquiry Received/Booking Confirmation email once they have completed their enquiry/booking (and reach your custom return URL page). As these emails will include a full summary of their enquiry/bookings (including their DMN Booking refence), it&rsquo;s not necessary to show these details on your return URL. We would recommend to have a generic &lsquo;Thanks for enquiry/booking&rsquo; message.</p>

<p>The following enquiry/booking details will be sent with the redirect to the return URL:</p>

<ul>
<li>First Name</li>
<li>Last Name</li>
<li>Email</li>
<li>Number of People</li>
<li>Time</li>
<li>Date</li>
<li>Duration</li>
<li>DOB</li>
<li>Phone</li>
</ul>

<p><strong>3. How do we get the booking reference number on our custom return URL page?</strong></p>

<p>It will be fed back through the url. This script will parse the url and get the booking parameters out.</p>

<pre><code>&lt;script&gt;
  var queryParams = document.location.search.substr(1).split('&amp;');
  var paramsEl = document.getElementById('all-params');
 
for ( var i = 0; i &lt; queryParams.length; i++ ){
  var currentParam = queryParams[i];
  var paramParts = currentParam.split('=');
 
  paramsEl.innerHTML += '&lt;li&gt;' + paramParts[0] + ': ' + paramParts[1];
}
&lt;/script&gt;
  &lt;div id=&quot;all-params&quot;&gt;
</code></pre>

<p><strong>4. Would it be possible to direct customers to different URLs depending on whether their booking in confirmed or comes into Collins as an enquiry?</strong></p>

<p>The booking info will be passed back in the URL.</p>

<p>When using the POST return method, you need to ensure that your webserver and application can accept POST requests from the designmynight.com domain, including any subdomain.</p>

<p>You will need to pick the <code>status</code> out of url if using a GET return method, or <code>status</code> out of the POST body.</p>

<p>Enquiries will have a status of <code>in_progress</code> and a confirmed booking will have a status of <code>complete</code>.</p>

<p>It will be up to your web developer to handle this logic on the return url to determine what information to display e.g &ldquo;Thank you for enquiry&rdquo; or &ldquo;Thank you for booking&rdquo;.</p>

			
			<aside class="copyright" role="note">
				
				&copy; 2020 DesignMyNight &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">
					Material
				</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="https://developers.designmynight.com/collins/updating-email-settings/" title="">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="https://developers.designmynight.com/collins/taking-bookings-from-google/" title="">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>




			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="https://developers.designmynight.com/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(headers.length > 0) {
        for(var i = 0; i < headers.length; i++) {
          var li = document.createElement("li");
          li.setAttribute("class", "anchor");

          var a  = document.createElement("a");
          a.setAttribute("href", "#" + headers[i].id);
          a.setAttribute("title", headers[i].innerHTML);
          a.innerHTML = headers[i].innerHTML;
          
          li.appendChild(a)
          scrollspy.appendChild(li);
        }
      } else {
        scrollspy.parentElement.removeChild(scrollspy)
      }
      

      /* Add permanent link next to the headers */
      var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

      for(var i = 0; i < headers.length; i++) {
          var a = document.createElement("a");
          a.setAttribute("class", "headerlink");
          a.setAttribute("href", "#" + headers[i].id);
          a.setAttribute("title", "Permanent link")
          a.innerHTML = "#";
          headers[i].appendChild(a);
      }
    </script>

    
      <script>
        (function(i,s,o,g,r,a,m){
          i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||
          []).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;
          m.parentNode.insertBefore(a,m)
        })(window, document,
          'script', '//www.google-analytics.com/analytics.js', 'ga');
         
        ga('create', 'UA-12385609-13', 'auto');
        ga('set', 'anonymizeIp', true);
        ga('send', 'pageview');
         
        var buttons = document.querySelectorAll('a');
        Array.prototype.map.call(buttons, function(item) {
          if (item.host != document.location.host) {
            item.addEventListener('click', function() {
              var action = item.getAttribute('data-action') || 'follow';
              ga('send', 'event', 'outbound', action, item.href);
            });
          }
        });
         
        var query = document.querySelector('.query');
        query.addEventListener('blur', function() {
          if (this.value) {
            var path = document.location.pathname;
            ga('send', 'pageview', path + '?q=' + this.value);
          }
        });
      </script>
    

    <script src="https://developers.designmynight.com/javascripts/highlight.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>